/*! d3.chart - v0.2.0
 *  License: MIT Expat
 *  Date: 2014-01-09
 */
(function(t){function e(t){var e,r,n,a;if(!t)return t;for(r=arguments.length,e=1;r>e;e++)if(n=arguments[e])for(a in n)t[a]=n[a];return t}(function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.DataMap=e()})(this,function(){"use strict";function t(){}function e(t){this.attrs=t,this.proxy=s(t)}var r=function(){var t={};try{Object.defineProperty(t,"test",{get:function(){return!0}})}catch(e){return!1}return!!t.test}(),n=Object.prototype.toString,a=Array.isArray||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&"[object Array]"==n.call(t)||!1},i={ES5:function(e){if("object"!=typeof e)return e;var r=Object.create(this.proxy);return e instanceof t&&(r=Object.create(e)),r._dataPoint=e,r},legacy:function(t){var e,r,n;return"object"!=typeof t?t:(e={},n=this._dataMapping,n?this.attrs.forEach(function(a){r=n[a],e[a]=r?r.call(t):t[a]},this):this.attrs.forEach(function(r){e[r]=t[r]}),e)}},o=i[r?"ES5":"legacy"],s=function(e){var n=new t;return e&&e.forEach(function(t){var e=function(){return this._dataPoint[t]};r?Object.defineProperty(n,t,{get:e,configurable:!0}):n[t]=e},this),n};return e.prototype.map=function(t){r?Object.keys(t).forEach(function(e){Object.defineProperty(this.proxy,e,{get:function(){return t[e].call(this._dataPoint)}})},this):this._dataMapping=t},e.prototype.wrap=function(t){return a(t)?t.map(o,this):o.call(this,t)},e});var r=t.d3,n=Object.hasOwnProperty,a=function(t,e){if(!t)throw Error("[d3.chart] "+e)};a(r,"d3.js is required"),a("string"==typeof r.version&&r.version.match(/^3/),"d3.js version 3 is required");var i=/^(enter|update|merge|exit)(:transition)?$/,o=function(t){a(t,"Layers must be initialized with a base."),this._base=t,this._handlers={}};o.prototype.dataBind=function(){a(!1,"Layers must specify a `dataBind` method.")},o.prototype.insert=function(){a(!1,"Layers must specify an `insert` method.")},o.prototype.on=function(t,e,r){return r=r||{},a(i.test(t),"Unrecognized lifecycle event name specified to `Layer#on`: '"+t+"'."),t in this._handlers||(this._handlers[t]=[]),this._handlers[t].push({callback:e,chart:r.chart||null}),this._base},o.prototype.off=function(t,e){var r,n=this._handlers[t];if(a(i.test(t),"Unrecognized lifecycle event name specified to `Layer#off`: '"+t+"'."),!n)return this._base;if(1===arguments.length)return n.length=0,this._base;for(r=n.length-1;r>-1;--r)n[r].callback===e&&n.splice(r,1);return this._base},o.prototype.draw=function(t){var e,n,i,o,s,c,h,p;e=this.dataBind.call(this._base,t),a(e&&e.call===r.selection.prototype.call,"Invalid selection defined by `Layer#dataBind` method."),a(e.enter,"Layer selection not properly bound."),n=e.enter(),n._chart=this._base._chart,i=[{name:"update",selection:e},{name:"enter",selection:this.insert.bind(n)},{name:"merge",selection:e},{name:"exit",selection:e.exit.bind(e)}];for(var l=0,u=i.length;u>l;++l)if(c=i[l].name,o=i[l].selection,"function"==typeof o&&(o=o()),!o.empty()){if(a(o&&o.call===r.selection.prototype.call,"Invalid selection defined for '"+c+"' lifecycle event."),s=this._handlers[c])for(h=0,p=s.length;p>h;++h)o._chart=s[h].chart||this._base._chart,o.call(s[h].callback);if(s=this._handlers[c+":transition"],s&&s.length)for(o=o.transition(),h=0,p=s.length;p>h;++h)o._chart=s[h].chart||this._base._chart,o.call(s[h].callback)}},r.selection.prototype.layer=function(t){var e,r=new o(this);if(r.dataBind=t.dataBind,r.insert=t.insert,"events"in t)for(e in t.events)r.on(e,t.events[e]);return this.on=function(){return r.on.apply(r,arguments)},this.off=function(){return r.off.apply(r,arguments)},this.draw=function(){return r.draw.apply(r,arguments)},this};var s=function(t,e){var r=this.constructor,a=r.__super__;a&&s.call(a,t,e),n.call(r.prototype,"initialize")&&this.initialize.apply(t,e)},c=function(t,e){var r=this.constructor,a=r.__super__;return this===t&&n.call(this,"transform")&&(e=this.transform(e)),n.call(r.prototype,"transform")&&(e=r.prototype.transform.call(t,e)),a&&(e=c.call(a,t,e)),e},h=function(t,e){this.base=t,this._dataMapping=e&&e.dataMapping,this._layers={},this._attached={},this._events={},s.call(this,this,Array.prototype.slice.call(arguments,1)),this._dataMapping!==!1&&(this._datamap=new DataMap(this.dataAttrs),this._dataMapping&&this._datamap.map(this._dataMapping))};h.prototype.initialize=function(){},h.prototype.unlayer=function(t){var e=this.layer(t);return delete this._layers[t],delete e._chart,e},h.prototype.layer=function(t,e,r){var n;if(1===arguments.length)return this._layers[t];if(2===arguments.length){if("function"==typeof e.draw)return e._chart=this,this._layers[t]=e,this._layers[t];a(!1,"When reattaching a layer, the second argument must be a d3.chart layer")}return n=e.layer(r),this._layers[t]=n,e._chart=this,n},h.prototype.attach=function(t,e){return 1===arguments.length?this._attached[t]:(this._attached[t]=e,e)},h.prototype.draw=function(t){var e,r,n;this._dataMapping!==!1&&t&&(t=this._datamap.wrap(t)),t=c.call(this,this,t);for(e in this._layers)this._layers[e].draw(t);for(r in this._attached)n=this.demux?this.demux(r,t):t,this._attached[r].draw(n)},h.prototype.on=function(t,e,r){var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:r||this,_chart:this}),this},h.prototype.once=function(t,e,r){var n=this,a=function(){n.off(t,a),e.apply(this,arguments)};return this.on(t,a,r)},h.prototype.off=function(t,e,r){var n,a,i,o,s,c;if(0===arguments.length){for(t in this._events)this._events[t].length=0;return this}if(1===arguments.length)return i=this._events[t],i&&(i.length=0),this;for(n=t?[t]:Object.keys(this._events),s=0;n.length>s;s++)for(a=n[s],i=this._events[a],c=i.length;c--;)o=i[c],(e&&e===o.callback||r&&r===o.context)&&i.splice(c,1);return this},h.prototype.trigger=function(t){var e,r,n=Array.prototype.slice.call(arguments,1),a=this._events[t];if(void 0!==a)for(e=0;a.length>e;e++)r=a[e],r.callback.apply(r.context,n);return this},h.extend=function(t,r,a){var i,o,s=this;i=r&&n.call(r,"constructor")?r.constructor:function(){return s.apply(this,arguments)},e(i,s,a);var c=function(){this.constructor=i};return c.prototype=s.prototype,i.prototype=new c,r&&e(i.prototype,r),i.__super__=s.prototype,o=n.call(i.prototype,"dataAttrs")?i.prototype.dataAttrs:[],o=o.concat(s.prototype.dataAttrs),i.prototype.dataAttrs=o,h[t]=i,i},r.chart=function(t){return 0===arguments.length?h:1===arguments.length?h[t]:h.extend.apply(h,arguments)},r.selection.prototype.chart=function(t,e){if(0===arguments.length)return this._chart;var r=h[t];return a(r,"No chart registered with name '"+t+"'"),new r(this,e)},r.selection.enter.prototype.chart=function(){return this._chart},r.transition.prototype.chart=r.selection.enter.prototype.chart})(this);
//@ sourceMappingURL=d3.chart.min.map